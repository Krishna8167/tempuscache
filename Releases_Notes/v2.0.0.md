## v2.0.0 - 2026-02-12

TempusCache
===========

[](https://golang.org/)

[](https://golang.org/)

[](LICENSE)

> A concurrent, in-memory key-value cache for Go with per-key TTL and optional background expiration.

TempusCache is a lightweight, thread-safe caching library designed for backend services that require low-latency storage with time-based lifecycle control.

It provides:

-   Deterministic behavior

-   Predictable performance

-   Safe concurrent access

-   Explicit lifecycle management

-   Clean, extensible architecture

* * * * *

‚ú® Features
----------

-   ‚úÖ Thread-safe read/write operations

-   ‚è≥ Per-entry TTL support

-   üö´ Never returns stale data (lazy expiration)

-   üßπ Optional background cleanup worker

-   ‚öôÔ∏è Functional configuration model

-   üß™ Race-condition safe (`go test -race`)

-   üìä Benchmark-tested

-   üîå Extensible (eviction policies planned)

* * * * *

üì¶ Installation
---------------

`go get github.com/yourusername/tempuscache`

* * * * *

üöÄ Quick Start
--------------

### Import

`import "github.com/yourusername/tempuscache"`

### Create Cache

`cache := tempuscache.New(
    tempuscache.WithCleanupInterval(10 * time.Second),
)`

If no cleanup interval is provided, the cache operates using **lazy expiration only**.

* * * * *

### Set Value

`cache.Set("user:1", "Krish", 5*time.Second)`

-   `ttl > 0` ‚Üí expires after duration

-   `ttl == 0` ‚Üí never expires

* * * * *

### Get Value

`value, found := cache.Get("user:1")
if found {
    fmt.Println(value)
}`

Expired entries are removed automatically and treated as cache misses.

* * * * *

### Delete Value

`cache.Delete("user:1")`

* * * * *

### Graceful Shutdown

`cache.Stop()`

Stops the background cleanup goroutine (if configured).

* * * * *

üèó Architecture
---------------

| Component | Responsibility |
| --- | --- |
| `cache.go` | Core storage & concurrency control |
| `item.go` | TTL metadata & expiration logic |
| `janitor.go` | Background cleanup worker |
| `options.go` | Functional configuration pattern |
| `eviction.go` | Reserved for future eviction strategies |
| `*_test.go` | Validation & concurrency testing |
| `benchmark_test.go` | Performance measurement |

* * * * *

‚è± Expiration Strategy
---------------------

TempusCache implements a **dual expiration model**.

### Lazy Expiration (Always Enabled)

-   Checked during `Get()`

-   Expired entries are removed immediately

-   Guarantees stale data is never returned

### Active Expiration (Optional)

-   Configurable cleanup interval

-   Background goroutine scans and deletes expired entries

-   Prevents memory retention of unused keys

If cleanup is disabled, lazy expiration alone ensures correctness.

* * * * *

üîí Concurrency Model
--------------------

The internal map is protected using `sync.RWMutex`.

-   `RLock()` ‚Üí reads

-   `Lock()` ‚Üí writes & cleanup

Benefits:

-   Concurrent reads

-   No race conditions

-   No concurrent map write panics

-   Verified with `go test -race`

* * * * *

‚öôÔ∏è Configuration (Functional Options Pattern)
---------------------------------------------

`cache := tempuscache.New(
    tempuscache.WithCleanupInterval(5 * time.Second),
)`

### Why Functional Options?

-   Stable constructor signature

-   Explicit configuration

-   Easy future extensibility

-   Clean API surface

* * * * *

üìà Performance
--------------

| Operation | Complexity |
| --- | --- |
| Set | O(1) |
| Get | O(1) |
| Delete | O(1) |
| Cleanup Cycle | O(n) |

Cleanup cycles perform full map scans.\
For moderate workloads, performance remains predictable and efficient.

* * * * *

üß™ Testing & Benchmarking
-------------------------

Run tests:

`go test ./...`

Run race detection:

`go test -race ./...`

Run benchmarks:

`go test -bench=. -benchmem`

Benchmarks report:

-   `ns/op`

-   `B/op`

-   `allocs/op`

* * * * *

üß† Design Decisions
-------------------

### Expiration Stored as `int64` (UnixNano)

-   Faster numeric comparison

-   Lower overhead than `time.Time`

-   Cache-friendly representation

-   Reduced memory footprint

### `RWMutex` over `Mutex`

-   Optimized for read-heavy workloads

-   Concurrent readers allowed

-   Safe writes

### Dual Expiration Model

-   Lazy expiration ‚Üí correctness

-   Active expiration ‚Üí memory hygiene

* * * * *

üõ£ Roadmap
----------

Planned enhancements:

-   LRU eviction policy

-   Capacity-based eviction

-   Sharded locking to reduce contention

-   Metrics tracking (hits, misses, evictions)

-   Observability hooks

-   Prometheus integration

* * * * *

üéØ Use Cases
------------

-   API response caching

-   Authentication/session storage

-   Rate limiting metadata

-   Temporary computation caching

-   Microservice in-memory storage layer

* * * * *

üõ† Development
--------------

`go test ./...
go test -race ./...
go test -bench=. -benchmem`

* * * * *

üìÑ License
----------

MIT License

* * * * *

Philosophy
----------

TempusCache is intentionally:

-   Minimal

-   Transparent

-   Idiomatic Go

-   Concurrency-safe

-   Built for predictable backend performancev2.0.0
------

TempusCache v2 introduces API-level changes and improved lifecycle control.

### Breaking Changes

-   Module path updated to:

    `github.com/yourusername/tempuscache/v2`

-   Constructor signature updated to use functional options

-   Internal expiration handling refactored

### Added

-   Functional configuration model

-   Configurable cleanup interval

-   Improved benchmark coverage

### Changed

-   Expiration metadata now stored as int64 (UnixNano) for performance

-   Improved lock strategy for read-heavy workloads

### Migration Guide

1.  Update import path:

    `import "github.com/yourusername/tempuscache/v2"`

2.  Update constructor usage:

    `cache := tempuscache.New(
        tempuscache.WithCleanupInterval(5 * time.Second),
    )`

* * * * *

üß† What NOT to Put in Release Notes
===================================

Do NOT copy your README into release notes.

Release notes are:

-   Version-specific

-   Change-focused

-   Concise

README = project overview\
Release notes = delta from previous version

* * * * *

üéØ For TempusCache Specifically
===============================

Since this is an infrastructure library, your release notes should sound:

-   Stable

-   Technical

-   Minimal marketing

-   Clear about breaking changes

Keep it precise.